# 儿童发育行为评估测试流程逻辑说明

## 测试流程概述

根据《0岁～6岁儿童发育行为评估量表（儿心量表-Ⅱ）》标准，测试流程如下：

### 1. 测试启动
- 确定主测月龄（根据儿童实际月龄确定）
- 先测查主测月龄的所有项目（5个能区）

### 2. 向前测查阶段
- 从主测月龄向前测查2个月龄
- 对每个能区分别判断：
  - 如果该能区连续2个月龄的项目均通过，则该能区向前测查结束
  - 如果该能区连续2个月龄的项目有任何一项未通过，需继续往前测查，直到该能区向前的连续2个月龄的项目均通过为止

### 3. 向后测查阶段
- 从主测月龄向后测查2个月龄
- 对每个能区分别判断：
  - 如果该能区连续2个月龄的项目均不通过，则该能区向后测查结束
  - 如果该能区连续2个月龄的项目有任何一项通过，需继续往后测查，直到该能区向后的连续2个月龄的项目均不通过为止

### 4. 测试结束条件
- 所有能区均完成向前和向后测查
- 至少测查5个月龄的项目（主测月龄 + 向前2个月龄 + 向后2个月龄）

## 详细流程图

```
开始测试
    ↓
确定主测月龄
    ↓
测查主测月龄项目（5个能区）
    ↓
检查是否需要向前测查
    ↓
是 → 向前测查阶段
    ↓
对每个能区：
- 测查前2个月龄项目
- 判断连续通过情况
- 决定是否继续向前
    ↓
检查是否需要向后测查
    ↓
是 → 向后测查阶段
    ↓
对每个能区：
- 测查后2个月龄项目
- 判断连续不通过情况
- 决定是否继续向后
    ↓
所有能区完成测查
    ↓
计算各能区智龄
    ↓
计算总体智龄
    ↓
计算发育商
    ↓
生成测试报告
    ↓
结束测试
```

## 计分规则

### 各能区计分
1. **1月龄～12月龄**：每个能区1.0分
2. **15月龄～36月龄**：每个能区3.0分
3. **42月龄～84月龄**：每个能区6.0分

### 智龄计算
1. 把连续通过的测查项目读至最高分
2. 连续两个月龄通过则不再往前继续测，默认前面的全部通过
3. 不通过的项目不计算
4. 通过的项目（含默认通过的项目）分数逐项加上，为该能区的智龄

### 总体智龄计算
将五个能区所得分数相加，再除以5就是总的智龄，保留一位小数。

### 发育商计算
发育商 = (智龄 / 实际月龄) × 100

## 发育商参考范围
- ﹥130：优秀
- 110～129：良好
- 80～109：中等
- 70～79：临界偏低
- ﹤70：智力发育障碍

## 测试要求
1. 测查环境应安静，光线明亮
2. 严格按照操作方法和测查通过要求进行操作
3. 避免被试儿童家长暗示、启发、诱导
4. 主试者应经过专业培训获得相关资质

## 当前实现问题分析

### 问题1：测试结束过早
- **现象**：测试5月龄只测了5月和4月就结束了
- **原因**：动态测评逻辑没有严格按照标准执行
- **解决方案**：确保至少测查5个月龄，强制完成向前和向后测查

### 问题2：计分逻辑错误
- **现象**：全点通过却显示智力障碍
- **原因**：月龄计算和计分逻辑有误
- **解决方案**：修复月龄计算，正确实现计分规则

### 问题3：UI优化需求
- **需求**：操作说明用有颜色的卡片框起来
- **解决方案**：优化测试页面UI，改进信息展示 